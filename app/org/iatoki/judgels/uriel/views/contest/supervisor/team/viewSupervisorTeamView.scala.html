@(contestId: Long, contestTeam: org.iatoki.judgels.uriel.ContestTeam, form: Form[org.iatoki.judgels.uriel.ContestTeamCoachCreateForm], form2: Form[org.iatoki.judgels.uriel.ContestTeamMemberCreateForm], coaches: List[org.iatoki.judgels.uriel.ContestTeamCoach], members: List[org.iatoki.judgels.uriel.ContestTeamMember], updateable: Boolean)

@import org.iatoki.judgels.uriel.controllers.routes

@import play.i18n.Messages
@import org.iatoki.judgels.commons.views.html.formErrorView
@import org.iatoki.judgels.commons.views.html.table.tableView
@import org.iatoki.judgels.jophiel.commons.JophielUtils
@import org.iatoki.judgels.uriel.views.html.contest.supervisorjs

@import org.iatoki.judgels.uriel.JidCacheService
@import scala.collection.JavaConversions

@implicitFieldConstructor = @{ b3.horizontal.fieldConstructor("col-md-3", "col-md-9") }

<h3>@contestTeam.getName</h3>

<h4>Coaches</h4>
@if(updateable) {
    @formErrorView(form)
    @b3.form(routes.ContestController.postCreateSupervisorTeamCoach(contestId, contestTeam.getId)) {

        @helper.CSRF.formField

        @b3.text(form("username"), '_label -> Messages.get("contestant.username"), 'class -> "form-control user_autocomplete")

        @b3.submit('class -> "btn btn-primary") {
            @Messages.get("commons.create")
        }
    }
}
@tableView() {
    <thead>
        <tr>
            <th>@Messages.get("commons.id")</th>
            <th>@Messages.get("team.coach.name")</th>
            @if(updateable) {
                <th></th>
            }
        </tr>
    </thead>
    <tbody>
        @defining(JidCacheService.getInstance().getDisplayNames(JavaConversions.seqAsJavaList(coaches.map(s => s.getCoachJid).toSeq))) { displayNamesMap =>
            @for(coach <- coaches) {
                <tr>
                    <td>@coach.getId</td>
                    <td>@displayNamesMap.get(coach.getCoachJid)</td>
                    @if(updateable) {
                        <td class="text-center">
                            <a href="@org.iatoki.judgels.uriel.controllers.routes.ContestController.removeSupervisorTeamCoach(contestId, contestTeam.getId, coach.getId)"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></a>
                        </td>
                    }
                </tr>
            }
        }
    </tbody>
}

<h4>Members</h4>
@if(updateable) {
    @formErrorView(form2)
    @b3.form(routes.ContestController.postCreateSupervisorTeamMember(contestId, contestTeam.getId)) {

        @helper.CSRF.formField

        @b3.text(form2("username"), '_label -> Messages.get("contestant.username"), 'class -> "form-control user_autocomplete")

        @b3.submit('class -> "btn btn-primary") {
            @Messages.get("commons.create")
        }
    }
}
@tableView() {
    <thead>
        <tr>
            <th>@Messages.get("commons.id")</th>
            <th>@Messages.get("team.member.name")</th>
            @if(updateable) {
                <th></th>
            }
        </tr>
    </thead>
    <tbody>
    @defining(JidCacheService.getInstance().getDisplayNames(JavaConversions.seqAsJavaList(members.map(s => s.getMemberJid).toSeq))) { displayNamesMap =>
        @for(member <- members) {
            <tr>
                <td>@member.getId</td>
                <td>@displayNamesMap.get(member.getMemberJid)</td>
                @if(updateable) {
                    <td class="text-center">
                        <a href="@org.iatoki.judgels.uriel.controllers.routes.ContestController.removeSupervisorTeamMember(contestId, contestTeam.getId, member.getId)"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></a>
                    </td>
                }
            </tr>
        }
    }
    </tbody>
}

<script type="text/javascript">
    var jophielAutoCompleteUrl = "@JophielUtils.getAutoCompleteEndPoint";
    var encodedAccessToken = "@JophielUtils.getEncodedAccessToken";
</script>
<script type="text/javascript" src="@controllers.routes.Assets.versioned("javascripts/userAutoComplete.js")"></script>

@supervisorjs(contestId)